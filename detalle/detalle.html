<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Detalle del Perfume</title>
  <link rel="stylesheet" href="../css/styles.css">
</head>
<body>
  <!-- Header con logo y menú -->

<header>
  <img src="../logo.png" alt="SC Parfums">
  <nav>
    <a href="../index.html">Inicio</a>
    <a href="../categorias/femeninos.html">Femeninos</a>
    <a href="../categorias/masculinos.html">Masculinos</a>
    <a href="../populares.html">Más Populares</a>
    <a href="../nuevo.html">Lo Nuevo</a>
    <a href="../ofertas.html">Ofertas</a>
    <a href="#contacto">Contacto</a>
  </nav>
  <div class="search-box">
    <input type="text" placeholder="Buscar fragancia...">
  </div>
</header>


  <main id="detalle-perfume">
    <p id="loader">Cargando detalles del perfume...</p>
  </main>

  <!-- Botón fijo de WhatsApp -->
  <div class="whatsapp-btn">
    <a id="btn-whatsapp" href="#" target="_blank">Consultar por WhatsApp</a>
  </div>

  <script>
    async function cargarDetalle() {
      const contenedor = document.getElementById('detalle-perfume');
      contenedor.innerHTML = '<p id="loader">Cargando detalles del perfume...</p>';

      try {
        const params = new URLSearchParams(window.location.search);
        const id = params.get("id");

        // Cargar detalles
        const resp = await fetch('../data/detalles.json');
        const detalles = await resp.json();
        const perfume = detalles.find(p => p.id === id);

        // Cargar catálogo para obtener nombre, marca, imagen y categoría
const respCatalogo = await fetch('../data/perfumes.json');
const catalogo = await respCatalogo.json();
const datosBasicos = catalogo.find(p => p.id === id);


        // Cargar precios
        const preciosResp = await fetch("https://script.googleusercontent.com/macros/echo?user_content_key=AY5xjrQ0kGvMknCQlBo-LPyJCKi1GrdYBCGkkrFvR5iBU7c7AMhUWNWiLUYsvIbTDjne-n97mYX4K6EaoTGXdss67vnVHRqviD85U2vNcdCAgD7F2CydaEzv5IPAX8R3cQa4Jt0i6IGuoKbR_ARoddGsj4XeS-AqIRXOruFbudrRARorBvUdYFTDBw4C6K5NQkGxUKSGPP39BqUqj6CJiB2WWL_vcaq3mUo3QyzTurldgUemqoDf4sce6jwnuk7cJIkEIyi5-cI4vPsl5kNvvGHGukV2nWuYEw&lib=MuhGdpCHVbtWl3sQABjAfXWqugQwYPpB1");
        const precios = await preciosResp.json();
        const precioData = precios.find(pr => pr.id === id);
        let precio = "Consultar";
        if (precioData && precioData.precio != null) {
          precio = "₲ " + precioData.precio.toLocaleString("es-PY");
        }

        if (!perfume) {
          contenedor.innerHTML = '<p>Perfume no encontrado.</p>';
          return;
        }

contenedor.innerHTML = `
  <div class="detalle-container">
    <div class="detalle-imagen">
      <img src="../${datosBasicos.imagen}" alt="${datosBasicos.nombre}">
    </div>
    <div class="detalle-info">
      <h1>${datosBasicos.nombre}</h1>
      <p><strong>${datosBasicos.marca}</strong></p>
      <p class="precio">${precio}</p>
      <section>
        <h3>Categoría</h3>
        <p>${datosBasicos.categoria}</p>
      </section>
      <section>
        <h3>Acordes principales</h3>
        <ul>${perfume.acordes.map(a => `<li>${a}</li>`).join('')}</ul>
      </section>
      <section>
        <h3>Notas de salida</h3>
        <ul>${perfume.notas_salida.map(n => `<li>${n}</li>`).join('')}</ul>
      </section>
      <section>
        <h3>Notas de corazón</h3>
        <ul>${perfume.notas_corazon.map(n => `<li>${n}</li>`).join('')}</ul>
      </section>
      <section>
        <h3>Notas de base</h3>
        <ul>${perfume.notas_base.map(n => `<li>${n}</li>`).join('')}</ul>
      </section>
      <section>
        <h3>Ocasiones de uso</h3>
        <p>${perfume.ocasion || "No especificado"}</p>
      </section>
      <section>
        <h3>Descripción</h3>
        <p>${perfume.descripcion}</p>
      </section>
    </div>
  </div>
`;

        // Botón de WhatsApp dinámico
        const btnWhats = document.getElementById("btn-whatsapp");
        btnWhats.href = `https://wa.me/595991861112?text=Hola, quiero consultar por el perfume ${perfume.nombre || perfume.id}`;
      } catch (error) {
        console.error("Error cargando detalle:", error);
        contenedor.innerHTML = '<p>Error al cargar detalles.</p>';
      }
    }

    cargarDetalle();
  </script>
</body>
</html>

